(function(){var g={}; var _ = _ || {}
var f=function(window){var ON="An unknown error occurred while trying to get volume",PN="Cannot get loading rendition due to platform limitations",QN="PARAM_START_POSITION",RN="SecurityError",SN="The require privilege is: http://tizen.org/privilege/tv.audio",TN="|STARTBITRATE\x3d",UN=function(a,b,c){function d(e){c.call(a,e);a.removeEventListener(b,d)}a.addEventListener(b,d)},VN=function(a,b){this.h=a;this.o=null;this.a=_.Ze;this.l=null;this.j=!1;this.f=new Map;this.C=b;this.g=new _.K("clpp.tizen.DrmEngine")},YN=function(a){var b,
c,d;return _.I(function(e){if(1==e.a){b=a.a===_.Vd||a.a===_.Td;if(!b)throw new _.N(_.O,6,6001,"The key system "+a.a+" is not supported by the player or the platform");c=a.f.get(a.a);if(!c.Vd)throw new _.N(_.O,6,6012,"No license server given for "+a.a);_.D(e,2);return a.a===_.Vd?_.y(e,WN(a),5):_.y(e,XN(a,c),5)}if(2!=e.a)return a.o={keySystem:a.a,licenseServerUri:c.Vd,distinctiveIdentifierRequired:!1,persistentStateRequired:c.Zf,audioRobustness:"",videoRobustness:"",serverCertificate:null,initData:[],
keyIds:[],periodId:null},_.th(e,0);d=_.E(e);a.g.error("Error while configuring CDM for "+a.a,d);throw new _.N(_.O,6,6005,{message:JSON.stringify(d)});})},XN=function(a,b){var c,d,e,f;return _.I(function(g){c=ZN;d=$N;e={};e[d.Hi]=!b.Zf;e[d.Ji]=b.Vd;""!==b.customData&&(e[d.Gi]=b.customData);f=JSON.stringify(e);a.g.debug("PlayReady properties: ",f);try{webapis.avplay.setDrm(c.PLAYREADY,"SetProperties",f)}catch(h){throw h;}_.B(g)})},WN=function(a){var b;return _.I(function(c){b=ZN;try{webapis.avplay.setDrm(b.je,
"Initialize",""),webapis.avplay.setDrm(b.je,"widevine_app_session",a.l.id),webapis.avplay.setDrm(b.je,"widevine_data_type",a.l.type)}catch(d){throw d;}_.B(c)})},aO=function(a,b){var c,d,e,f,g,h,l,m,n,p,q,u,v,z,A,G,F;_.I(function(C){if(1==C.a){c=ZN;d=a.f.get(a.a);a.g.debug("DRM Challenge data: ",b.challenge);e=atob(b.challenge);f=new Uint8Array(e.length);for(g=0;g<e.length;++g)f[g]=e.charCodeAt(g);h=b.serverurl&&""!==b.serverurl?b.serverurl:d.Vd;l=_.Mj([h],_.Jj());l.type=3;l.body=f.buffer;l.method=
_.Mb;_.D(C,2);return _.y(C,a.C.wb.fetch(l).P,4)}if(2!=C.a){m=C.f;if(a.j){n=_.oj(m.data);p=n.byteLength;q="";for(u=0;u<p;u++)q+=String.fromCharCode(n[u]);v=btoa(q);z=b.session_id+QN+(v+QN);a.g.debug("Widevine license params",z);try{webapis.avplay.setDrm(c.je,"widevine_license_data",z)}catch(H){a.g.error("License response rejected by CDM"),A=new _.N(_.O,6,6008,{browserError:JSON.stringify(H)}),a.C.onError(A)}}return _.th(C,0)}G=_.E(C);a.g.error("License request failed.",JSON.stringify(G));F=new _.N(_.O,
6,6007,{message:_.cb,url:G.data.url,status:G.data.status||NaN,response:G.data.response||"",headers:G.data.headers||{}},G);a.C.onError(F);_.B(C)})},bO=function(a){this.m=a;this.a=this.m.a;this.f=_.np;this.j=_.op;this.w=(new Date).getTime();this.l=!1;this.o=-1;this.h=2;this.g=new _.K("clpp.tizen.StateManager")},dO=function(a,b){if(a.f!==b)if(a.f===_.yp&&b!==_.np)a.g.debug(_.OB+cO(b));else{var c=(new Date).getTime();a.j=a.f;a.f=b;a.f===_.sp?(a.o=(new Date).getTime(),a.m.trigger(new _.L(_.od,{detail:{bufferedTimeMS:-1,
reason:a.h}}))):a.j===_.sp&&a.m.trigger(new _.L(_.nd,{detail:{bufferedTimeMS:c-a.o,reason:a.h}}));var d={currentState:a.f,previousState:a.j,timeSinceLastStateChangeMS:c-a.w};a.w=c;a.m.trigger(new _.L(_.jg,{detail:d}));a.g.debug("State changed:",cO(a.j),"-\x3e",cO(a.f))}},cO=function(a){return Object.keys(_.wp)[a]},gO=function(a){if(a.l){var b=a.a.getState(),c=a.f;switch(b){case eO:c=_.Bp;break;case fO:c=_.Ap;break;default:a.m.isEnded()?c=_.up:a.g.debug("Inconsistent AVPlay playback state:",b)}dO(a,
c)}},hO=function(){this.o=this.A=this.f=this.h=this.B=this.m=this.j=this.a=null;this.D=!1;this.w=!0;this.l=null;this.g=new _.K("clpp.tizen.TextStreamer")},iO=function(a){if(!a)return!1;a=a.periods;for(var b=!1,c=0;c<a.length;c++)b=b||0<a[c].textStreams.length;return b},jO=function(a){var b,c;return _.I(function(d){if(1==d.a)return b=a.m.getConfiguration(),c=null,_.y(d,_.Pt(a.B.url,a.m.getNetworkEngine(),b.manifest.attemptParameters,a.B.type||null),2);(c=d.f)&&c.configure(b.manifest);return d["return"](c)})},
kO=function(a){var b=document.createElement(_.r),c=new _.xE,d=new _.YC,e=a.m.getTextDisplayer();return new _.zE(b,c,e,d,a.m.getConfiguration())},lO=function(a){var b={configuration:{},Hb:function(){return a.m.getPosition()},W:a.h,wb:a.m.getNetworkEngine(),Qf:a.gk.bind(a),Pf:a.fk.bind(a),onError:a.T.bind(a),Vh:function(){},onEvent:function(){},Zh:a.hk.bind(a),Le:function(){},we:function(){return new _.BF},mf:function(){return!1},yd:null};return new _.vG(a.a,b)},mO=function(a){var b=a.m.getPosition(),
c=null;a=_.w(a.a.periods);for(var d=a.next();!d.done;d=a.next())d=d.value,d.startTime<=b&&(c=d);return c},nO=function(a){a.g.debug("getTextStreams()",a.a);if(a.a){var b=[],c=a.a.periods;a.g.debug("getting text streams");for(var d=0;d<c.length;d++)if(a.g.debug(c[d].startTime,a.m.getPosition()),c[d].startTime<=a.m.getPosition()){b=c[d].textStreams;break}a=b}else a=[];b=[];for(d=c=0;d<a.length;d++){var e=new _.hk(String(c++),_.T);e.mimeType=a[d].mimeType;e.language=a[d].language;e.roles=a[d].roles;e.kind=
a[d].kind||_.tC;var f=new _.sk(String(a[d].id),e);f.bandwidth=a[d].bandwidth||null;e.renditions.push(f);b.push(e)}return b},oO=function(a){if(a.h&&!a.h.getTextDisplayer().isTextVisible())return null;if(a.f){var b=_.yG(a.f,_.P),c=null;if(b){a=nO(a);for(var d=0;d<a.length;d++)if(a[d].renditions[0].id===String(b.id)){c=a[d].renditions[0];break}}return c}return null},pO=function(a,b){a.g.debug("Set active track",b);if(b&&(a.o=b.language,a.A=b.roles[0]||"",a.D=b.kind===_.ue,a.a&&a.f)){a.setTextVisibility(!0);
var c=mO(a),d=b.renditions[0];(c=c.textStreams.find(function(e){return String(e.id)===d.id}))?(a.w?(a.g.debug("Switching period defer text selection"),a.l=c):(_.JG(a.f,c,!0,0),a.m.trigger(new _.L(_.Sl))),a.o=c.language):a.g.error(_.NB,d.id)}},qO=function(){this.h=this.a=this.m=null;this.f={};this.g=new _.K("clpp.tizen.TrackManager");this.w=this.l=this.j=null;this.A=!1;this.o=1},rO=function(a,b){a.m.trigger(new _.L(_.Og,{details:{width:b.width,height:b.height,bandwidth:b.bandwidth,track:b.track,abrSelection:a.a.o}}))},
sO=function(a){var b=a.na();b&&a.m.trigger(new _.L(_.ld,{detail:{width:b.width,height:b.height,bandwidth:b.bandwidth,rendition:b}}))},tO=function(a){var b=a.m.getConfiguration(),c=_.mi(b.preferredAudioLanguage||[]),d=a.f[_.jk]||[];if(d.length){var e=null;c.some(function(g){e=_.PC(g,d.map(function(h){return h.language}));return!!e});if(e){var f=d.filter(function(g){return g.language===e});c=f[0];1<f.length&&b.preferredAudioRole&&(f=f.filter(function(g){return 0<=g.roles.indexOf(b.preferredAudioRole)}),
0<f.length&&(c=f[0]));a.g.debug("Setting audio track with preferred language:",e);a.Ba(c)}else a.g.debug("Preferred language(s) not available")}else a.g.debug("Could not set preferred audio language")},xO=function(a,b){if(b){var c=b.track.type.toUpperCase();uO(a.a,c,Number(b.id)).then(function(){c===vO&&(a.j=b,a.m.trigger(new _.L(_.Rl)));c===wO&&(a.l=b,a.m.trigger(new _.L(_.Sl)))})["catch"](function(){a.g.error("Could not select "+c+" track.")})}else a.g.debug("Must provide valid rendition")},yO=
function(a,b,c){var d=_.gj(b.language||_.yg);c.language=_.ik(d);c.originalLanguage=d;c.channelsCount=b.channels?Number(b.channels):null;c.mimeType=_.hd;a=new _.sk(String(a),c);a.track=c;a.codec=b.fourCC||null;a.bandwidth=b.bit_rate||null;return a},zO=function(a,b,c){c.mimeType=_.Mg;a=new _.sk(String(a),c);a.track=c;a.width=b.Width||null;a.height=b.Height||null;a.bandwidth=b.Bit_rate?Number(b.Bit_rate):null;a.codec=b.fourCC||null;return a},AO=function(a,b,c){b=_.gj(b.track_lang||_.yg);c.mimeType="text/ttml";
c.language=_.ik(b);c.originalLanguage=b;c.kind=_.tC;return new _.sk(String(a),c)},BO=function(a,b){var c=null;try{c=JSON.parse(b)}catch(d){a.g.warn("Couldn't retrieve extra infos from stream."),c=null}return c},EO=function(a,b){function c(n,p){for(var q=0;q<n.length;q++)if(n[q].language===p)return n[q];return null}var d={};if(0>=b.length)return d;for(var e=b.filter(function(n){return n.type===CO}),f=b.filter(function(n){return n.type===vO}),g=[],h=0;h<f.length;h++){var l=BO(a,f[h].extra_info);if(l){var m=
_.gj(l.language||_.yg);m=_.ik(m);m=c(g,m);m||(m=new _.hk(String(a.o++),_.jk),g.push(m));m.renditions.push(yO(f[h].index,l,m))}else a.g.warn("Skipping audio stream with no extra info")}f=new _.hk(String(a.o++),_.kk);for(h=0;h<e.length;h++)(l=BO(a,e[h].extra_info))?f.renditions.push(zO(e[h].index,l,f)):a.g.warn("Skipping video stream with no extra info");e=[];e=a.h?nO(a.h):DO(a,b);d[_.kk]=[f];d[_.jk]=g;d[_.T]=e;return d},DO=function(a,b){for(var c=b.filter(function(h){return h.type===wO}),d=[],e=0;e<
c.length;e++){var f=BO(a,c[e].extra_info);if(f){var g=new _.hk(String(a.o++),_.T);g.renditions.push(AO(c[e].index,f,g));d.push(g)}else a.g.warn("Skipping text stream with no extra info")}return d},FO=function(a,b){for(var c=a.f[_.kk]||[],d=[],e=0;e<c.length;e++)for(var f=0;f<c[e].renditions.length;f++)_.M.la(c[e].renditions[f],b,Object.keys(b))&&d.push(c[e].renditions[f]);return d[0]||null},GO=function(a,b,c){a=a.f[c]||[];b=String(b.index);c=null;for(var d=0;d<a.length;d++)for(var e=0;e<a[d].renditions.length;e++)if(a[d].renditions[e].id===
b){c=a[d].renditions[e];break}return c},IO=function(a,b){if(b===_.T&&a.h)return oO(a.h);var c=HO(a.a)||[];if(0===c.length)return null;c=c.filter(function(e){return e.type===b.toUpperCase()})[0];var d=null;b===_.kk&&(d=BO(a,c.extra_info),d=FO(a,{width:d.Width,height:d.Height}));b===_.jk&&(c?(d=GO(a,c,_.jk),a.j=d):d=a.j);b===_.T&&(c?(d=GO(a,c,_.T),a.l=d):d=a.l);return d},JO=function(a){_.Yl.call(this);this.m=a;this.h=null;this.g=new _.K("clpp.tizen.Middleware");this.D=1;this.B=!1;this.l=null;this.G=
0;this.o=!0;this.f=!1;this.a=null;this.A=1;this.w=!1;this.j={}},KO=function(a){return _.I(function(b){tizen.systeminfo.getPropertyValue("DISPLAY",function(c){a.A=c.resolutionWidth/1920;a.g.debug("Display resolution ratio: ",a.A)},function(c){a.g.debug("Could not load DISPLAY property");throw c;});_.B(b)})},MO=function(a){try{webapis.avplay.setListener({onbufferingstart:a.ak.bind(a),onbufferingprogress:a.$j.bind(a),onbufferingcomplete:a.Zj.bind(a),onstreamcompleted:a.dk.bind(a),oncurrentplaytime:function(b){a.trigger(new _.L(LO,
{currentTime:b}))},onevent:a.ck.bind(a),onsubtitlechange:a.ek.bind(a),ondrmevent:a.bk.bind(a),onerror:a.T.bind(a)})}catch(b){a.g.error(b)}},NO=function(a){var b=!!a.m.getTrackManager().Ja();try{webapis.avplay.setSilentSubtitle(!b)}catch(c){a.g.debug("Could not set AVPlay subtitle config",c)}},OO=function(a,b){try{var c=b.estimatedBandwidth||0,d=b.currentBandwidth||0;a.g.debug({estimatedBandwidth:c,Yn:d});0!==c&&0!==d&&c>=1.15*d&&webapis.avplay.setStreamingProperty("ADAPTIVE_INFO",TN+d)}catch(e){a.g.debug(e)}},
PO=function(a,b){try{webapis.avplay.setStreamingProperty("ADAPTIVE_INFO","|BITRATES\x3d"+b+TN+b)}catch(c){throw a.g.debug("Could not set fixed bandwidth",c),c;}},SO=function(a){return{position:a.getPosition(),state:a.m.getState(),Cg:a.getState(),playbackRate:a.getPlaybackRate(),isLive:a.isLive(),duration:a.getDuration(),isMuted:QO(a),volume:a.getVolume(),un:RO(a),wk:HO(a)}},UO=function(a){var b,c;return _.I(function(d){if(1==d.a)return _.y(d,TO(),2);if(3!=d.a)return b=new Promise(function(e){(new _.Zk(e)).da(5)}),
_.y(d,Promise.race([KO(a).then(function(){return!0}),b.then(function(){return!1})]),3);c=d.f;if(!c)return a.g.debug("Took to long for the SDK to be ready"),d["return"](Promise.reject("SDK Timeout"));_.B(d)})},$O=function(a,b,c){var d,e,f,g,h,l,m,n;return _.I(function(p){switch(p.a){case 1:a.l=_.Fp(b);d=a.G;e=c||{estimatedBandwidth:0,currentBandwidth:0,nextBandwidth:null,currentPosition:0};a.g.debug("Loading manifest URL: "+a.l[d].url);f=b.startTime||void 0;a.f&&(a.trigger(new _.L(VO)),f=c.currentPosition);
_.D(p,2);g=a.l[d].url;h=a.l[d].type;h!==_.Wc||g.includes(".mpd")||(l=new URL(g),l.searchParams.append("cl-ext",".mpd"),g=l.toString());webapis.avplay.open(g);e.nextBandwidth?(PO(a,e.nextBandwidth),a.o=!1):(a.o||OO(a,e),a.o=!0);MO(a);if(!b.drm||!b.drm.env){a.g.debug("No DRM configuration was provided. Assuming clear content");p.F(4);break}m={onError:function(q){return a.m.onError(q)},wb:a.m.getNetworkEngine()};a.h=new VN(b.drm,m);return _.y(p,a.h.init(),4);case 4:return a.f||a.trigger(new _.L(WO)),
_.y(p,XO(a),6);case 6:a.f||a.trigger(new _.L(YO));f&&typeof f===_.k&&0<f&&a.seek(f)["catch"](function(q){a.g.debug("Couldn't set start position",q)});a.f||(b.volume&&a.setVolume(b.volume),b.muted&&ZO(a,b.muted),b.autoplay&&a.m.play()["catch"](function(q){a.g.debug("Autoplay failed",q)}));_.th(p,0);break;case 2:throw n=_.E(p),a.g.debug("Error while attempting to load source."),n;}})},XO=function(a){return _.I(function(b){a.g.debug("avplay.prepare()");return b["return"](new Promise(function(c,d){try{webapis.avplay.prepareAsync(function(){a.g.debug("AVPlay is ready!");
NO(a);c()},function(e){a.g.debug("prepareAsync failed",e);d(e)})}catch(e){a.g.debug("Failed to prepare media player for playback"),d(e)}}))})},aP=function(a,b,c){a.g.debug("switchVideoTrack()");try{var d={estimatedBandwidth:parseInt(webapis.avplay.getStreamingProperty("CURRENT_BANDWITH"),10),currentBandwidth:b,nextBandwidth:c,currentPosition:a.getPosition()};a.a=SO(a);a.f=!0;webapis.avplay.stop();webapis.avplay.close();return a.load(a.m.getConfiguration(),d).then(function(){var e=a.a.Cg;a.f=!1;a.a=
null;return e===fO?a.pause():a.play()})}catch(e){return Promise.reject(e)}},RO=function(a){return a.f&&a.a?a.a.un:webapis.avplay.getTotalTrackInfo()},HO=function(a){return a.f&&a.a?a.a.wk:webapis.avplay.getCurrentStreamInfo()},uO=function(a,b,c){b=b.toUpperCase();b===wO&&bP(a,!0);var d=a.j[b];d&&(d.Re.stop(),a.j[b]=null,a.g.debug("Cancelled pending track switch for "+b));return new Promise(function(e,f){function g(h,l,m){m=void 0===m?!1:m;try{webapis.avplay.setSelectTrack(h,l),a.j[h]=null,e()}catch(n){a.g.debug("Could not set "+
h+" track. Trying again...AVPlay state: "+(a.getState()+", buffering: ")+a.w,n),!1===m&&(a.j[h]={type:h,index:l,zg:0,Re:new _.Zk(function(){return g(h,c,!0)})}),(l=a.j[h])&&3>l.zg?(!a.w&&++l.zg,l.Re.da(a.w?.5:.25)):(a.g.debug("Could not set track after multiple attempts.Giving up..."),l&&l.Re.stop(),a.j[h]=null,f())}}g(b,c)})},bP=function(a,b){var c=a.m.getTextDisplayer();c&&c.setTextVisibility(b);c=a.m.h;try{c||webapis.avplay.setSilentSubtitle(!b)}catch(d){a.g.debug("Could not set text track visibility",
d)}},ZO=function(a,b){try{tizen.tvaudiocontrol.setMute(b)}catch(c){switch(c.name){case RN:a.g.warn("The application does not have the privilege to set mute.",SN);break;default:a.g.warn(ON,c)}}},QO=function(a){var b=null;try{b=tizen.tvaudiocontrol.isMute()}catch(c){switch(c.name){case RN:a.g.warn("The application doesn't have the privilege to get the mute state.",SN);break;default:a.g.warn(ON,c)}}return!!b},TO=function(){return new Promise(function(a,b){if(window.webapis)a();else{var c=document.createElement("script");
UN(c,"load",function(d){return a(d)});UN(c,_.te,function(d){return b(d)});c.src="$WEBAPIS/webapis/webapis.js";document.querySelector("head").appendChild(c)}})},cP=function(){_.Yl.call(this);this.a=new JO(this);this.f=new bO(this);this.configuration=this.B=_.dm();this.w=null;this.g=new _.K("clpp.tizen.Player");this.j=null;this.l=new qO;this.D=new _.dk;this.o=this.h=null;this.A=!1},dP=function(a){if("NONE"!==a.a.getState()){var b=a.j.getBoundingClientRect();a=a.a;var c=Math.floor(b.left*a.A),d=Math.floor(b.top*
a.A),e=Math.floor(b.width*a.A);b=Math.floor(b.height*a.A);a.g.debug("Setting display area to","x:",c,"y:",d,"width:",e,"height:",b);webapis.avplay.setDisplayRect(c,d,e,b);0===c&&0===d&&1920===e&&1080===b&&webapis.avplay.setDisplayMethod("PLAYER_DISPLAY_MODE_LETTER_BOX")}else a.g.debug("Could not apply dimension. Player state "+a.a.getState())},eP=function(){},fP=function(){};
VN.prototype.init=function(){var a=this,b,c,d,e,f,g;return _.I(function(h){if(1==h.a){b=_.ym[a.h.env]||null;if(!b)throw a.g.debug(_.Aa,_.Sb+a.h.env+_.ba),new _.N(_.O,6,6015,_.Da+a.h.env+"' is missing.");a.l={id:String(Math.floor(1E4*Math.random())),type:"MPEG-DASH"};c=Object.keys(a.h.customData||{}).length?btoa(JSON.stringify(a.h.customData)):"";d=_.Am(b,a.h.customData);(e=d[_.Td])&&a.f.set(_.Td,{Vd:e.licenseUrl||"",customData:c,Zf:!1});(f=d[_.Vd])&&a.f.set(_.Vd,{Vd:f.licenseUrl||"",customData:c,
Zf:!1});if(0===a.f.size)throw new _.N(_.O,6,6E3);if((g=a.h.preferredDrmSystem)&&a.f.get(g))a.a=g;else if(a.f.get(_.Td))a.a=_.Td;else if(a.f.get(_.Vd))a.a=_.Vd;else throw new _.N(_.O,6,6001,"Configuration for the target system is missing.");return _.y(h,YN(a),2)}a.j=!0;_.B(h)})};VN.prototype.release=function(){var a=this;return _.I(function(b){a.j=!1;a.o=null;a.a=_.Ze;a.l=null;a.f=new Map;_.B(b)})};VN.prototype.getDrmInfo=function(){return this.o};
var $N={Hi:"DeleteLicenseAfterUse",Ji:"LicenseServer",Kn:"GetChallenge",Ln:"HttpHeader",Nn:"UserAgent",Fn:"Cookie",Gi:"CustomData"};_.t=bO.prototype;_.t.initialize=function(){this.a.on(VO,this.Xg,this);this.a.on(gP,this.Wg,this);this.a.on(hP,this.Vg,this);this.a.on(WO,this.bi,this);this.a.on(YO,this.ai,this);this.a.on(iP,this.Yg,this)};_.t.release=function(){dO(this,_.np);this.l=!1;this.o=-1;this.h=2};_.t.destroy=function(){this.release();this.a.off(VO,this.Xg);this.a.off(gP,this.Wg);this.a.off(hP,this.Vg);this.a.off(WO,this.bi);this.a.off(YO,this.ai);this.a.off(iP,this.Yg);this.m=this.a=null};
_.t.Xg=function(){this.g.debug("Buffering start. Player state: ",this.a.getState());this.h=this.a.B?1:2;dO(this,_.sp)};_.t.Wg=function(a){this.g.debug("Buffering progress: "+a.percent+" %. Player state: ",cO(this.f))};_.t.Vg=function(){this.g.debug("Buffering complete. Player state: ",this.a.getState());if(!this.l){this.l=!0;var a=this.m.getConfiguration().autoplay,b=this.a.getState()===jP;if(!a&&b){dO(this,_.Ap);return}}if(a=this.f!==_.zp)a=this.a.getState(),a=a===eO||a===fO;a&&gO(this)};
_.t.bi=function(){this.g.debug("Preparing starts. AVPlay State: ",this.a.getState());this.a.getState()===kP?dO(this,_.zp):this.g.error("AVPlay prepares while state is not IDLE")};_.t.ai=function(){this.g.debug("Preparing ends: AVPlay state:",this.a.getState())};_.t.Yg=function(){dO(this,_.up)};_.t.getState=function(){return this.f};_.t=hO.prototype;_.t.initialize=function(a){this.m=a};
_.t.load=function(a){var b=this,c,d,e,f,g,h,l;return _.I(function(m){switch(m.a){case 1:if(!b.m)return b.g.debug("Text streamer is not initialized. Will not load()"),m["return"]();b.B=a;c=b;return _.y(m,jO(b),2);case 2:c.j=m.f;if(!b.j)return b.g.debug("Could not find manifest parser for source. Make sure parsers are registered."),m["return"]();d={configurationId:"",networkingEngine:b.m.getNetworkEngine(),filterNewPeriod:function(){},filterAllPeriods:function(){},onTimelineCueAdded:function(){},onEvent:function(){},
onError:function(){}};_.D(m,3);e=b;return _.y(m,b.j.start(a.url,d),5);case 5:e.a=m.f;_.th(m,4);break;case 3:return f=_.E(m),b.g.warn(f),_.D(m,6),g=b,_.y(m,b.j.start(a.url.replace("https://","http://"),d),8);case 8:g.a=m.f;_.th(m,4);break;case 6:h=_.E(m),b.g.error(h),b.a=null;case 4:if(!b.a||!iO(b.a)){m.F(0);break}b.h=kO(b);_.D(m,10);return _.y(m,b.h.open(),12);case 12:b.f=lO(b);l=b.m.getConfiguration();b.f.h=l.streaming;b.o=l.preferredTextLanguage;b.A=l.preferredTextRole;b.D=l.preferForcedSubtitles;
_.th(m,0);break;case 10:_.E(m),b.g.debug("Could not setup media source..."),b.h=null,b.f=null,b.j=null,b.a=null,_.B(m)}})};_.t.gk=function(a){this.g.debug(_.lC,a);this.w=!0;var b=_.$E(a.textStreams,this.o||"",this.A||"",this.D)[0]||null;this.l&&(a.textStreams.includes(this.l)&&(b=this.l),this.l=null);return{variant:null,text:b}};_.t.fk=function(){this.g.debug("canSwitch_");this.w=!1;this.l&&(_.JG(this.f,this.l,!0,0),this.l=null)};_.t.T=function(){this.g.debug("onError_")};
_.t.hk=function(){this.j&&this.j.update&&this.j.update()};_.t.start=function(){var a=this;return _.I(function(b){if(!a.f)return b["return"]();try{a.f.start()}catch(c){a.g.error("Error while starting streaming engine",c)}_.B(b)})};_.t.setTextVisibility=function(a){this.g.debug("Set text visibility",a);this.h&&this.h.getTextDisplayer().setTextVisibility(a)};_.t.release=function(){var a=this;return _.I(function(b){a.m=null;a.a=null;a.B=null;a.A=null;a.o=null;a.w=!0;a.l=null;_.B(b)})};
_.t.destroy=function(){var a=this;return _.I(function(b){switch(b.a){case 1:if(!a.j){b.F(2);break}return _.y(b,a.j.stop(),3);case 3:a.j=null;case 2:if(!a.f){b.F(4);break}return _.y(b,a.f.destroy(),5);case 5:a.f=null,a.w=!0;case 4:if(!a.h){b.F(0);break}return _.y(b,a.h.destroy(),7);case 7:a.h=null,_.B(b)}})};_.x(qO,_.U);_.t=qO.prototype;_.t.Rh=function(a){var b=a.eventid;a=a.data;switch(b){case lP:0<Object.keys(this.f).length||(this.g.debug("Loading track manager!"),this.load());b=webapis.avplay.getCurrentStreamInfo();0<b.length&&(b=+BO(this,b[0].extra_info).Bit_rate,b=FO(this,{bandwidth:b}))&&(this.w=b,rO(this,b));break;case mP:sO(this);break;default:this.g.debug("Event type: "+b+" data: "+a)}};_.t.Uf=function(a){a.detail.currentState===_.Bp&&this.m.off(_.jg,this.Uf)};
_.t.initialize=function(a){var b=this;this.m=a;this.a=this.m.a;this.m.on(_.jg,function(c){b.A||(c=c.detail,c.currentState===_.Bp&&(b.g.debug("Current state",c.currentState),b.A=!0,tO(b)))});this.a.on(nP,this.Rh,this)};_.t.release=function(){this.f={};this.h=this.w=this.l=this.j=null;this.A=!1;this.o=1};
_.t.load=function(){if(this.a&&!(0<Object.keys(this.f).length)){this.h=this.m.h;this.m.off(_.jg,this.Uf);this.m.on(_.jg,this.Uf,this);try{var a=RO(this.a);this.f=EO(this,a);var b=this.f[_.jk]||[];b.length&&(this.j=b[0].renditions[0]||null);sO(this)}catch(c){this.g.debug("Could not load track manager")}}};_.t.destroy=function(){this.a.off(nP,this.Rh);this.a=this.m=null};_.t.getVideoTracks=function(){return this.f[_.kk]||[]};_.t.getAudioTracks=function(){return this.f[_.jk]||[]};
_.t.ia=function(){return this.f[_.T]||[]};_.t.na=function(){return IO(this,_.kk)};_.t.Qa=function(){return IO(this,_.jk)};_.t.Ja=function(){return IO(this,_.T)};_.t.fb=function(){return this.w};_.t.ob=function(){this.g.info(PN);return null};_.t.pb=function(){this.g.info(PN);return null};_.t.Ka=function(){var a=this.na();return a?a.track:null};_.t.ma=function(){var a=this.Qa();return a?a.track:null};_.t.wa=function(){var a=this.Ja();return a?a.track:null};
_.t.lb=function(a){var b=this;null===a?(a=this.na(),aP(this.a,a.bandwidth,null).then(function(){sO(b)})):0<a.renditions.length&&this.$a(a.renditions[0])};_.t.Ba=function(a){a?xO(this,a.renditions[0]):this.g.warn("Cannot disable audio tracks on this platform.","Consider muting audio instead...")};_.t.Ma=function(a){a?(a=a.renditions[0],this.h?pO(this.h,a.track):xO(this,a)):(this.g.debug("Disabling text tracks"),this.l=null,bP(this.a,!1),this.m.trigger(new _.L(_.Sl)))};
_.t.$a=function(a){var b=this,c=this.na();this.a.o||a.width!==c.width||a.height!==c.height||a.bandwidth!==c.bandwidth?(this.w=a,rO(this,a),aP(this.a,c.bandwidth,a.bandwidth).then(function(){sO(b)})["catch"](function(d){var e=new _.N(_.O,7,7200,{tizenerror:d});b.g.debug("Error while switching video track",d);b.m.onError(e)})):this.g.debug("Trying to switch to already active rendition. Doing nothing...")};_.t.jb=function(a){xO(this,a)};_.t.kb=function(a){this.h?pO(this.h,a.track):xO(this,a)};
_.t.addTextTrack=function(){};_.t.ra=function(){return this.a.o};qO.prototype.isAbrEnabled=qO.prototype.ra;qO.prototype.addTextTrack=qO.prototype.addTextTrack;qO.prototype.setTextRendition=qO.prototype.kb;qO.prototype.setAudioRendition=qO.prototype.jb;qO.prototype.setVideoRendition=qO.prototype.$a;qO.prototype.setTextTrack=qO.prototype.Ma;qO.prototype.setAudioTrack=qO.prototype.Ba;qO.prototype.setVideoTrack=qO.prototype.lb;qO.prototype.getTextTrack=qO.prototype.wa;qO.prototype.getAudioTrack=qO.prototype.ma;
qO.prototype.getVideoTrack=qO.prototype.Ka;qO.prototype.getLoadingTextRendition=qO.prototype.pb;qO.prototype.getLoadingAudioRendition=qO.prototype.ob;qO.prototype.getLoadingVideoRendition=qO.prototype.fb;qO.prototype.getTextRendition=qO.prototype.Ja;qO.prototype.getAudioRendition=qO.prototype.Qa;qO.prototype.getVideoRendition=qO.prototype.na;qO.prototype.getTextTracks=qO.prototype.ia;qO.prototype.getAudioTracks=qO.prototype.getAudioTracks;qO.prototype.getVideoTracks=qO.prototype.getVideoTracks;_.x(JO,_.Yl);_.t=JO.prototype;_.t.ak=function(){this.w=!0;this.f||this.trigger(new _.L(VO))};_.t.$j=function(a){this.w=!0;this.trigger(new _.L(gP,{percent:a}))};_.t.Zj=function(){this.w=!1;this.trigger(new _.L(hP))};_.t.dk=function(){this.trigger(new _.L(iP))};_.t.ck=function(a,b){this.trigger(new _.L(nP,{eventid:a,data:b}))};_.t.ek=function(a,b,c,d,e){this.trigger(new _.L(oP,{duration:a,text:b,subtitleType:c,attriCount:d,attributes:e}))};
_.t.bk=function(a,b){this.trigger(new _.L(pP,{drmType:a,drmData:b}));if(this.h){var c=this.h;if(c.j)if(c.a===_.Vd&&"Challenge"===b.name)aO(c,b);else if("DrmError"===b.name){c.g.debug("DrmError event",b);var d=new _.N(_.O,6,6005,{message:JSON.stringify(b)});c.C.onError(d)}}};_.t.T=function(a){this.trigger(new _.L(qP,{eventType:a}))};
_.t.play=function(){function a(){return new Promise(function(d,e){function f(){d();clearTimeout(g)}var g=null;b.one(LO,f,b);g=setTimeout(function(){b.off(LO,f);e("Timeout")},3E4)})}var b=this,c=this.getState();if(c===kP)return(new Promise(function(d,e){webapis.avplay.prepareAsync(function(){NO(b);d(webapis.avplay.play())},function(f){b.trigger(new _.L(qP));e(f)})})).then(function(){return a()});if(c===fO||c===jP)try{return webapis.avplay.play(),a()}catch(d){return Promise.reject(d)}return c===eO?
Promise.resolve():Promise.reject("Player is in invalid state")};_.t.pause=function(){try{webapis.avplay.pause()}catch(a){Promise.reject(a)}return this.getState()===fO?Promise.resolve():Promise.reject()};
_.t.setPlaybackRate=function(a){var b=this.getState();if(b===jP||b===eO||b===fO){try{webapis.avplay.setSpeed(a),this.D=a}catch(c){return this.g.debug("Error while trying to set playback rate",c),this.setPlaybackRate(this.D)}return!0}this.g.debug("Cannot set playback rate; AVPlay is in inconsistent state: "+b);return!1};_.t.getPlaybackRate=function(){return this.D};
_.t.load=function(a,b){var c=this,d;return _.I(function(e){switch(e.a){case 1:return c.g.debug("configure()",b||""),_.D(e,2),_.y(e,UO(c),4);case 4:return _.y(e,$O(c,a,b),5);case 5:_.th(e,0);break;case 2:throw d=_.E(e),new _.N(_.O,7,7003,null,d);}})};_.t.getState=function(){if(this.f&&this.a)return this.a.Cg;try{return webapis.avplay.getState()}catch(a){this.T(JSON.stringify(a))}};
_.t.seek=function(a){var b=this,c=1E3*a;return new Promise(function(d,e){b.B=!0;b.m.trigger(new _.L(_.Gg));webapis.avplay.seekTo(c,function(){b.B=!1;b.m.trigger(new _.L(_.Dg));d()},function(){b.B=!1;e()})})};_.t.getPosition=function(){if(this.f&&this.a)return this.a.position;try{return webapis.avplay.getCurrentTime()/1E3}catch(a){this.T(JSON.stringify(a))}};_.t.getDuration=function(){if(this.f&&this.a)return this.a.duration;try{return webapis.avplay.getDuration()/1E3}catch(a){this.T(JSON.stringify(a))}};
_.t.release=function(){var a=this;return new Promise(function(b,c){try{a.h&&(a.h.release(),a.h=null);webapis.avplay.stop();webapis.avplay.close();for(var d in a.j){var e=a.j[d];e&&e.Re.stop()}a.j={};a.D=1;a.B=!1;a.l=null;a.a=null;return b()}catch(f){return c(f)}})};_.t.getVolume=function(){var a=null;try{a=tizen.tvaudiocontrol.getVolume()}catch(b){switch(b.name){case RN:this.g.debug("The application does not have the privilege to get the volume.",SN);break;default:this.g.debug(ON,b)}}return a};
_.t.setVolume=function(a){try{tizen.tvaudiocontrol.setVolume(Math.max(0,Math.min(100*a,100)))}catch(b){switch(b.name){case "InvalidValueError":this.g.warn("Invalid value passed for setVolume.","The passed value value should be in the range of 0 to 1.");break;case RN:this.g.warn("The application does not have the privilege to set the volume.",SN);break;default:this.g.warn("An unknown error occurred while trying to set volume",b)}}};
_.t.isLive=function(){if(this.f&&this.a)return this.a.isLive;try{return"1"===webapis.avplay.getStreamingProperty("IS_LIVE")}catch(a){this.T(JSON.stringify(a))}};_.t.stop=function(){try{webapis.avplay.stop()}catch(a){this.g.debug(a)}};_.t.getDrmInfo=function(){this.h&&this.h.getDrmInfo();return null};_.t.setSourceIndex=function(a){this.G=a};_.t.getSourceIndex=function(){return this.G};_.t.getLoadedSource=function(){return this.l&&this.l[this.getSourceIndex()]};
var kP="IDLE",jP="READY",eO="PLAYING",fO="PAUSED",CO=_.nc,vO="AUDIO",wO="TEXT",mP="PLAYER_MSG_RESOLUTION_CHANGED",lP="PLAYER_MSG_BITRATE_CHANGE",ZN={PLAYREADY:"PLAYREADY",Hn:"EME_PLAYREADY",On:"VERIMATRIX",je:"WIDEVINE_CDM",In:"EME_WIDEVINE_CDM",Qn:"WIDEVINE_CLASSIC"};_.x(cP,_.Yl);_.t=cP.prototype;_.t.Tg=function(){var a=this;this.g.debug("On Stream completed. Current time: ",this.getPosition());this.trigger(new _.L(_.se));this.configuration.loop?this.seek(this.configuration.startTime||0)["catch"](function(){a.g.debug("Could not loop playback")}):this.a.stop()};_.t.Rg=function(a){this.trigger(new _.L(_.ug,{currentTime:a.currentTime/1E3}))};
_.t.Ug=function(a){var b=this.a.getPosition(),c=b+a.duration/1E3,d=a.text||"";this.g.debug("Got subtitles: ",d,"start:",b,"end:",c,a);(d=_.S.kg(d))&&this.o.append([new _.xi(b,c,d)],[])};_.t.Sg=function(a){this.g.debug("DRM event: "+a.drmType+", data: "+a.drmData)};_.t.Th=function(){this.A||(this.g.debug("Initial buffering completed..."),this.A=!0)};
_.t.T=function(a){this.g.debug("Error: TYPE: "+a.eventType);dO(this.f,_.yp);a=new _.N(_.O,7,7200,{tizenerror:a.eventType});this.a.release();this.trigger(new _.L(_.te,{detail:a}))};
_.t.init=function(a,b){this.configuration=this.B=b;this.w=a;this.a.on(iP,this.Tg,this);this.a.on(LO,this.Rg,this);this.a.on(oP,this.Ug,this);this.a.on(pP,this.Sg,this);this.a.on(qP,this.T,this);this.a.on(hP,this.Th,this);this.f.initialize();this.l.initialize(this);this.g.debug("Initializing player surface");this.w.hideMediaElement();var c=rP;rP+=1;this.j=_.Yp(_.$e,{id:"__clpp_tizen_player_"+c,type:"application/avplayer"});this.w.addElementToContainer(this.j,!0);var d=this.w.getMedia();if(d){c=this.j;
var e=[_.Zg,_.xe,"position",_.Fe,"top"],f={};d=null!==d.parentElement?window.getComputedStyle(d,null):d.style;if(!e||0===e.length){e||(e=[]);for(var g in d)e.push(g)}g=_.w(e);for(e=g.next();!e.done;e=g.next())e=e.value,f[e]=d[e];_.$p(c,f);dP(this)}};_.t.getSurface=function(){return this.w};_.t.getConfiguration=function(){return this.configuration};_.t.getTimeline=function(){return null};_.t.setupPlaylist=function(){return Promise.reject(_.Ib)};_.t.appendLoad=function(){return Promise.reject(_.Ib)};
_.t.seekWith=function(){return Promise.reject(_.Ib)};_.t.destroy=function(){var a=this;return _.I(function(b){switch(b.a){case 1:return _.y(b,a.release(),2);case 2:a.a.off(iP,a.Tg);a.a.off(LO,a.Rg);a.a.off(oP,a.Ug);a.a.off(pP,a.Sg);a.a.off(qP,a.T);a.a.off(hP,a.Th);if(!a.h){b.F(3);break}return _.y(b,a.h.destroy(),4);case 4:a.h=null;case 3:a.j&&(a.j.parentElement.removeChild(a.j),a.j=null),a.l.destroy(),a.f.destroy(),a.l=null,a.f=null,_.B(b)}})};_.t.namespace=function(){return sP};
_.t.getPlaybackRate=function(){return this.a.getPlaybackRate()};_.t.setDrmCustomDataModifier=function(){};_.t.setCdnErrorCallback=function(){};_.t.detach=function(){};_.t.setPlaybackRate=function(a){this.a.setPlaybackRate(a)};_.t.getPosition=function(){return this.getMediaPosition()};_.t.getMediaPosition=function(){return 0<(this.configuration.startTime||0)&&!this.A?0:this.f.getState()===_.up?this.getDuration():this.a.getPosition()||0};
_.t.seek=function(a){return typeof a===_.k&&0<=a?(this.isLive()||(a=Math.min(a,this.getDuration())),this.a.seek(a)):Promise.reject()};_.t.getPresentationStartTime=function(){return null};_.t.getSeekRange=function(){return{start:0,end:0}};_.t.getVolume=function(){var a=this.a.getVolume();return typeof a===_.k?a/100:null};_.t.setVolume=function(a){this.a.setVolume(a)};_.t.getDuration=function(){return this.getMediaDuration()};_.t.getMediaDuration=function(){return this.a.getDuration()};
_.t.getBufferInfo=function(){this.g.warn(_.va);return new _.Xl};_.t.getTrackManager=function(){return this.l};_.t.unload=function(){var a=this;return this.a.release().then(function(){a.l.release()})};_.t.release=function(){var a=this;return _.I(function(b){switch(b.a){case 1:if(!a.h){b.F(2);break}return _.y(b,a.h.release(),2);case 2:if(!a.o){b.F(4);break}return _.y(b,a.o.destroy(),5);case 5:a.o=null;case 4:return _.y(b,a.a.release(),6);case 6:a.l.release(),a.f.release(),a.A=!1,_.B(b)}})};
_.t.load=function(a){var b=this,c,d,e,f,g;return _.I(function(h){switch(h.a){case 1:b.configuration=_.fm(b.B,a);c=_.bp(b.configuration,[_.ze,"native"]);b.o=c.create(b);d=_.Fp(b.configuration)[0];e=!!b.configuration.tizen&&b.configuration.tizen.sideStreamText;if(!e){h.F(2);break}b.h=new hO;b.h.initialize(b);_.D(h,3);return _.y(h,b.h.load(d),5);case 5:b.h.start();_.th(h,2);break;case 3:f=_.E(h),b.g.error(f);case 2:return _.D(h,6),_.y(h,b.a.load(b.configuration),8);case 8:_.th(h,7);break;case 6:throw g=
_.E(h),b.onError(g),g;case 7:b.l.load(),_.B(h)}})};_.t.play=function(){var a=this;this.trigger(new _.L(_.of));dP(this);return this.a.play().then(function(){gO(a.f)})};_.t.pause=function(){var a=this;return this.a.pause().then(function(){gO(a.f)})};_.t.getState=function(){return this.f.getState()};_.t.getPeriods=function(){return[]};_.t.onError=function(a){var b=new _.L(_.te,{detail:a});a.severity===_.O&&(dO(this.f,_.yp),this.a.release());this.trigger(b);b.defaultPrevented&&(b.a=!0)};
_.t.getDrmInfo=function(){return this.a.getDrmInfo()};_.t.isEnded=function(){return this.f.getState()===_.up};_.t.isPaused=function(){return this.a.getState()===fO};_.t.isMuted=function(){return QO(this.a)};_.t.setMuted=function(a){ZO(this.a,a)};_.t.getNetworkEngine=function(){return this.D};_.t.setNetworkEngine=function(a){this.D=a};_.t.isLive=function(){return this.a.isLive()};_.t.getStats=function(){return null};_.t.setSourceIndex=function(a){this.a.setSourceIndex(a)};_.t.getSourceIndex=function(){return this.a.getSourceIndex()};
_.t.getLoadedSource=function(){return this.a.getLoadedSource()};_.t.canPlay=function(a,b){return(new eP).canPlay(a,b)};_.t.getTimelineCues=function(){return[]};_.t.getTextDisplayer=function(){return this.o};_.t.resetAbr=function(){};cP.prototype.getTextDisplayer=cP.prototype.getTextDisplayer;cP.prototype.setNetworkEngine=cP.prototype.setNetworkEngine;cP.prototype.getNetworkEngine=cP.prototype.getNetworkEngine;var sP="clpp.tizen",rP=0;eP.prototype.a=function(){return sP};
eP.prototype.canPlay=function(a){a=a.type;var b=!!window.webapis;if((a===_.Wc||a===_.Il||a===_.ad)&&b){if(_.Yj(2))return 2;if(_.Yj(3)||_.Yj(4)||_.Yj(5)||_.Yj(6))return _.Ih("Use of clpp.tizen.TizenComponent is not recommended for Tizen version \x3e\x3d 3."),1}return 0};eP.prototype.f=function(a){return a===_.qa};eP.prototype.create=function(){return new cP};_.x(fP,_.Ts);fP.prototype.f=function(){_.Sh(new eP)};fP.prototype.a=function(){var a=sP;a&&_.Qh[a]&&(delete _.Qh[a],_.Rh.info("Removed Player factory: '"+a+"'"))};fP.prototype.id=function(){return"tizen"};_.J("clpp.tizen.TizenComponent",fP);var VO="onbufferingstart",gP="onbufferingprogress",hP="onbufferingcomplete",iP="onstreamcompleted",LO="oncurrentplaytime",nP="onevent",oP="onsubtitlechange",pP="ondrmevent",qP="onerror",WO="preparingstart",YO="preparingend";};
if(typeof(module)!="undefined"&&module.exports){var x=require("./cl.core.js");_ = x._;(f.call(g,this));module.exports=g;}
else if (typeof(define)!="undefined"&&define.amd) {define(["./cl.core"], function(c){_=c._;(f.call(g,this));return g;});}
else{_=this.clpp._;(f.call(g,this));}
})();