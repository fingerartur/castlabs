(function(){var g={}; var _ = _ || {}
var f=function(window){var Wv=" The setting will be ignored.",Xv="VTT parser encountered an invalid VTT setting: ",Yv="application/x-subrip",Zv="text/srt",$v='text/vtt; codecs\x3d"vtt"',aw='text/vtt; codecs\x3d"wvtt"',bw=function(a){_.Gj(a,/[ \t]+/gm)},cw=function(a){return a.a===a.f.length?null:(a=_.Gj(a,/[^ \t\n]*/gm))?a[0]:null},dw=function(){},ew=function(a){var b="";for(a=a.split(/\n/);3<a.length;){for(var c=3;c<a.length;++c)a[2]+="\n"+a[c];a.splice(3,a.length-3)}if(3!==a.length)return"";c=0;!a[0].match(/\d+:\d+:\d+/)&&
a[1].match(/\d+:\d+:\d+/)&&(b+=a[0].match(/\w+/)+"\n",++c);if(a[c].match(/\d+:\d+:\d+/)){var d=a[1].match(/(\d+):(\d+):(\d+)(?:,(\d+))?\s*--?>\s*(\d+):(\d+):(\d+)(?:,(\d+))?/);if(d)b+=d[1]+":"+d[2]+":"+d[3]+"."+d[4]+" --\x3e ",b+=d[5]+":"+d[6]+":"+d[7]+"."+d[8]+"\n",++c;else return""}else return"";a[c]&&(b+=a[c]+"\n\n");return b},fw=function(){},gw=function(a){this.a=a},iw=function(a,b,c){var d;if(d=/^align:(start|middle|center|end|left|right)$/.exec(b))b=d[1],"middle"===b?a.textAlign=_.si:a.textAlign=
_.Mu[b.toUpperCase()];else if(d=/^vertical:(lr|rl)$/.exec(b))a.writingMode="lr"===d[1]?_.Jg:_.Kg;else if(d=/^size:([\d.]+)%$/.exec(b))a.size=Number(d[1]);else if(d=/^position:([\d.]+)%(?:,(line-left|line-right|center|start|end))?$/.exec(b))a.position=Number(d[1]),d[2]&&(b=d[2],a.positionAlign=b===_.Ie||b===_.ig?_.Ie:b===_.Je||b===_.re?_.Je:_.wd);else if(d=/^region:(.*)$/.exec(b)){if(b=hw(c,d[1]))a.region=b}else{a:{if(c=/^line:([\d.]+)%(?:,(start|end|center))?$/.exec(b))a.lineInterpretation=1,a.line=
Number(c[1]),c[2]&&(a.lineAlign=_.Nu[c[2].toUpperCase()]);else if(c=/^line:(-?\d+)(?:,(start|end|center))?$/.exec(b))a.lineInterpretation=_.ui,a.line=Number(c[1]),c[2]&&(a.lineAlign=_.Nu[c[2].toUpperCase()]);else{a=!1;break a}a=!0}return a}return!0},hw=function(a,b){var c=a.filter(function(d){return d.id===b});return c.length?c[0]:(_.Ih("VTT parser could not find a region with id: ",b," The region will be ignored."),null)},jw=function(a){a=_.Gj(a,/(?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{2,3})/g);if(null==
a)return null;var b=Number(a[2]),c=Number(a[3]);return 59<b||59<c?null:Number(a[4])/1E3+c+60*b+3600*(Number(a[1])||0)},kw=function(){gw.apply(this,arguments)},lw=function(){this.a=null;this.g=new _.K("clpp.vtt.mp4")},nw=function(a,b,c){var d,e,f;(new _.Rm).M("payl",_.Um(function(g){d=_.S.ba(g)})).M("iden",_.Um(function(g){e=_.S.ba(g)})).M("sttg",_.Um(function(g){f=_.S.ba(g)})).parse(a);return d?mw(d,e,f,b,c):null},mw=function(a,b,c,d,e){a=new _.xi(d,e,a,_.Rg);b&&(a.id=b);if(c)for(b=new _.Fj(c),c=
cw(b);c;)iw(a,c,[])||_.Ih(Xv,c,Wv),bw(b),c=cw(b);return a},ow=function(){this.j=new fw};dw.prototype.a=function(a){a=_.S.ba(a);a=a.replace(/\r+/g,"");a=a.replace(/^\s+|\s+$/g,"");a=a.replace(/<[a-zA-Z\\/][^>]*>/g,"");var b=a.split("\n\n");a="";if(0<b.length){a+="WEBVTT\n\n";b=_.w(b);for(var c=b.next();!c.done;c=b.next())a+=ew(c.value)}return _.S.Wa(a)};fw.prototype.create=function(){return new dw};fw.prototype.probe=function(a,b){return(a===Zv||a===Yv)&&b===_.sg};gw.prototype.parseInit=function(){};
gw.prototype.parseMedia=function(a,b){var c=_.S.ba(a);c=c.replace(/\r\n|\r(?=[^\n]|$)/gm,"\n");var d=c.split(/\n{2,}/m);if(!/^WEBVTT($|[ \t\n])/m.test(d[0]))throw new _.N(_.O,2,2E3);c=b.periodStart;if(d[0].includes("X-TIMESTAMP-MAP")){var e=d[0].match(/LOCAL:((?:(\d{1,}):)?(\d{2}):(\d{2})\.(\d{3}))/m),f=d[0].match(/MPEGTS:(\d+)/m);if(e&&f){c=jw(new _.Fj(e[1]));if(null==c)throw new _.N(_.O,2,2E3);f=Number(f[1]);for(e=b.segmentStart;95443.7176888889<=e;)e-=95443.7176888889,f+=8589934592;c=b.periodStart+
f/9E4-c}}else this.a.streaming.relativeTextTimestamp&&null!==b.segmentStart&&(c=b.segmentStart);f=[];e=_.w(d);for(var g=e.next();!g.done;g=e.next()){var h=g.value;if(/^region/.test(h.toLowerCase())){h=new _.Fj(h.replace(/\n/g," "));g=new _.Ai;cw(h);bw(h);for(var l=cw(h);l;){var m;a:{var n=g,p=l;if(m=/^id:(.*)$/.exec(p))n.id=m[1];else if(m=/^width:(\d{1,2}|100)%$/.exec(p))n.width=Number(m[1]);else if(m=/^lines:(\d+)$/.exec(p))n.height=Number(m[1]),n.heightUnits=2;else if(m=/^regionanchor:(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(p))n.regionAnchorX=
Number(m[1]),n.regionAnchorY=Number(m[2]);else if(m=/^viewportanchor:(\d{1,2}|100)%,(\d{1,2}|100)%$/.exec(p))n.viewportAnchorX=Number(m[1]),n.viewportAnchorY=Number(m[2]);else if(/^scroll:up$/.exec(p))n.scroll="up";else{m=!1;break a}m=!0}m||_.Ih("VTT parser encountered an invalid VTTRegion setting: ",l,Wv);bw(h);l=cw(h)}f.push(g)}}e=[];h=_.w(d);for(g=h.next();!g.done;g=h.next())if(g=g.value,/^style/.test(g.toLowerCase())){g=g.replace(/^style/i,"").replace(/\n/g," ");l=/[^{}]+{[^{}]*}/g;do(m=l.exec(g))&&
e.push(m[0]);while(m)}h=[];d=_.w(d);for(g=d.next();!g.done;g=d.next())if(g=g.value,g.includes("--\x3e")){p=g.split("\n");var q=c;if(1===p.length&&!p[0]||/^NOTE($|[ \t])/.test(p[0])||"STYLE"===p[0])g=null;else{g=null;p[0].includes("--\x3e")||(g=p[0],p.splice(0,1));l=new _.Fj(p[0]);m=jw(l);var u=_.Gj(l,/[ \t]+--\x3e[ \t]+/g);n=jw(l);if(null==m||null==u||null==n)throw new _.N(_.O,2,2001);m+=q;n+=q;p=p.slice(1).join("\n").trim();m=new _.xi(m,n,p,_.Rg);g&&(m.id=g);bw(l);for(n=cw(l);n;)iw(m,n,f)||_.Ih(Xv,
n,Wv),bw(l),n=cw(l);null!=g&&(m.id=g);g=m}g&&h.push(g)}return{cues:h,styles:e}};_.x(kw,gw);kw.prototype.parseMedia=function(a,b){return gw.prototype.parseMedia.call(this,(new dw).a(a),b)};lw.prototype.parseInit=function(a){var b=this,c=!1;(new _.Rm).M(_.We,_.Sm).M(_.vg,_.Sm).M(_.Re,_.Sm).Y("mdhd",function(d){0===d.version?(d.reader.skip(4),d.reader.skip(4),b.a=_.W(d.reader),d.reader.skip(4)):(d.reader.skip(8),d.reader.skip(8),b.a=_.W(d.reader),d.reader.skip(8));d.reader.skip(4)}).M(_.Ve,_.Sm).M(_.lg,_.Sm).Y(_.ng,_.Tm).M("wvtt",function(){c=!0}).parse(a);if(!this.a)throw new _.N(_.O,2,2008);if(!c)throw new _.N(_.O,2,2008);};
lw.prototype.parseMedia=function(a,b){if(!this.a)throw this.g.error("No init segment for MP4+VTT!"),new _.N(_.O,2,2008);var c=0,d=[],e,f=[],g=!1,h=!1,l=!1,m=null;(new _.Rm).M("moof",_.Sm).M("traf",_.Sm).Y("tfdt",function(H){g=!0;c=0===H.version?_.W(H.reader):_.Om(H.reader)}).Y("tfhd",function(H){var Q=H.flags;H=H.reader;H.skip(4);Q&1&&H.skip(8);Q&2&&H.skip(4);m=Q&8?_.W(H):null}).Y("trun",function(H){h=!0;var Q=H.version,R=H.flags;H=H.reader;var na=_.W(H);R&1&&H.skip(4);R&4&&H.skip(4);for(var da=[],
Ba=0;Ba<na;Ba++){var ab={duration:null,sampleSize:null,og:null};R&256&&(ab.duration=_.W(H));R&512&&(ab.sampleSize=_.W(H));R&1024&&H.skip(4);R&2048&&(ab.og=0===Q?_.W(H):_.Nm(H));da.push(ab)}d=da}).M(_.Qe,_.Um(function(H){l=!0;e=H})).parse(a);if(!l&&!g&&!h)throw new _.N(_.O,2,2008);var n=c,p=new DataView(e.buffer,e.byteOffset,e.byteLength);p=new _.Im(p,!1);for(var q=_.w(d),u=q.next();!u.done;u=q.next()){u=u.value;var v=u.duration||m,z=u.og?c+u.og:n;n=z+(v||0);var A=0;do{var G=_.W(p);A+=G;var F=_.W(p);
F=_.Wm(F);var C=null;"vttc"===F?8<G&&(C=_.Qm(p,G-8)):("vtte"!==F&&this.g.error("Unknown box "+F+"! Skipping!"),p.skip(G-8));v?C&&f.push(nw(C,b.periodStart+z/this.a,b.periodStart+n/this.a)):this.g.error("WVTT sample duration unknown, and no default found!")}while(u.sampleSize&&A<u.sampleSize)}return{cues:f.filter(_.Gi),styles:[]}};_.x(ow,_.Ts);ow.prototype.f=function(){_.tu(_.sg,gw);_.tu($v,gw);_.tu(aw,gw);_.tu(_.Zc,lw);_.tu(Zv,kw);_.tu(Yv,kw);_.Kk.push(this.j)};ow.prototype.a=function(){_.vu(_.sg);_.vu($v);_.vu(aw);_.vu(_.Zc);_.vu(Zv);_.vu(Yv);_.Mk(this.j)};ow.prototype.id=function(){return"subtitles-vtt"};_.J("clpp.vtt.VttComponent",ow);};
if(typeof(module)!="undefined"&&module.exports){var x=require("./cl.core.js");_ = x._;(f.call(g,this));module.exports=g;}
else if (typeof(define)!="undefined"&&define.amd) {define(["./cl.core"], function(c){_=c._;(f.call(g,this));return g;});}
else{_=this.clpp._;(f.call(g,this));}
})();