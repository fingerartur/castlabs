(function(){var g={}; var _ = _ || {}
var f=function(window){var fx='application/mp4; codecs\x3d"stpp.ttml"',gx='application/mp4; codecs\x3d"stpp.ttml.im1i"',hx='application/mp4; codecs\x3d"stpp.ttml.im1t"',ix="backgroundColor",jx="direction",kx="displayAlign",lx="region",mx="sans-serif",nx="textAlign",ox="textDecoration",px="writingMode",qx=function(a,b,c){this.h=a;this.f=b;this.a=c},rx=function(a,b,c){qx.call(this,a,[],c);this.j=b||""},sx=function(a,b,c){qx.call(this,a,b,c)},tx=function(a,b,c){a=a.f;for(var d=a.length-1;0<=d;d--){var e=b.get(a[d]);if(c in
e.a)return e.getAttribute(c)}return null},Bx=function(a,b){var c=null;if(ux.test(a)){c=ux.exec(a);var d=Number(c[1]),e=Number(c[2]),f=Number(c[3]),g=Number(c[4]);g+=(Number(c[5])||0)/b.f;f+=g/b.frameRate;c=f+60*e+3600*d}else vx.test(a)?c=wx(vx,a):xx.test(a)?c=wx(xx,a):yx.test(a)?(c=yx.exec(a),c=Number(c[1])/b.frameRate):zx.test(a)?(c=zx.exec(a),c=Number(c[1])/b.a):Ax.test(a)&&(c=wx(Ax,a));return c},wx=function(a,b){var c=a.exec(b);return null==c||""===c[0]?null:(Number(c[4])||0)/1E3+(Number(c[3])||
0)+60*(Number(c[2])||0)+3600*(Number(c[1])||0)},Cx=function(a){return a.split(":").pop()},Dx=function(a){return a.replace(/(\d*\.?\d+)c/g,"$1em")},Fx=function(a,b){for(;Ex.test(a);){var c=Ex.exec(a)[0];a=a.replace(c,parseInt(c,10)/b+"em")}return a},Gx=function(a){return a?a.replace(/(\d*\.?\d+)%/g,function(b,c){return c/100+"em"}):""},Hx=function(a,b,c,d,e,f,g){qx.call(this,a,f,g);this.w=b;this.A=c;this.o=d;this.l=e;this.j=[]},Ix=function(a,b,c){a=tx(a,b,nx);if(!a&&c&&(a=tx(c,b,nx),!a&&"rltb"===tx(c,
b,px)))return _.Wf;switch(a){case _.wd:return _.si;case _.Wf:case _.re:return _.Wf;default:return _.Fe}},Jx=function(a,b,c){if(_.S.He(a.w))return document.createTextNode(_.S.kg(a.w||""));if(a.A)return _.Yp("br");for(var d=_.Yp("span"),e=_.w(a.f),f=e.next();!f.done;f=e.next())_.Zp(d,f.value);a=_.w(a.j);for(e=a.next();!e.done;e=a.next())d.appendChild(Jx(c.get(e.value),b,c));return d},Kx=function(a,b,c,d){this.frameRate=Number(a)||30;this.f=Number(b)||1;this.a=Number(d);0===this.a&&(this.a=a?this.frameRate*
this.f:1);c&&(a=/^(\d+) (\d+)$/g.exec(c))&&(this.frameRate*=Number(a[1])/Number(a[2]))},Lx=function(a,b,c){qx.call(this,a,b,c)},Ox=function(a,b,c,d){var e=Mx.exec(a);a=Nx.exec(a);return typeof b===_.k&&0<b&&a?100*Number(a[c])/b:e?Number(e[c]):a?Number(a[c]):d},Px=function(a,b){return typeof b===_.k&&0<b?_.yi:Nx.test(a)?0:_.yi},Qx=function(a,b){qx.call(this,"root-container",[],b);this.j=a},Rx=function(a,b,c){return typeof a===_.k?a:typeof b===_.k?b:c},Sx=function(a,b){var c=a.getAttribute("extent");
return(c=Nx.exec(c))?Number(c[b]):null},Ux=function(a){a=a.getAttribute("cellResolution");return(a=Tx.exec(a))?Number(a[2]):null},Vx=function(a,b,c){qx.call(this,a,b,c)},Wx=function(a){this.B=a;this.w=this.l=null;this.A=0;this.h=new Map;this.a=new Map;this.j=new Map;this.f=new Map;this.o=[]},Yx=function(a){return Xx.some(function(b){return b in a.attributes})},Zx=function(a,b){if(0===b.length)return[];for(var c=[],d=_.w(b),e=d.next();!e.done;e=d.next())e=e.value,a.a.has(e)&&c.push.apply(c,_.fh(Zx(a,
a.a.get(e).f)).concat([e]));return c},ay=function(){return"inline-"+$x++},by=function(a){this.a=a.firstChild;this.f=new Set},cy=function(a,b,c,d,e,f){this.h=a;this.a=b;this.j=c;this.l=d;this.f=e;this.attributes=f},dy=function(a){return Cx(a.h.nodeName)},ey=function(){this.a=new Map},gy=function(a,b){if(a.a.has(b))return a.a.get(b);var c=null,d=null,e=[],f=[],g={},h=b.parentNode;if(h&&a.a.has(h)){var l=a.a.get(h);e=_.fh(l.l).concat();-1===["#text","span","br"].indexOf(b.nodeName)&&(c=l.a,d=l.j,f=_.fh(l.f).concat(),
g={},fy.forEach(function(n){n in l.attributes&&(g[n]=l.attributes[n])}))}if(b.nodeType===b.ELEMENT_NODE){b.hasAttribute(lx)&&(c=b.getAttribute(lx));b.hasAttribute(_.og)&&f.push.apply(f,_.fh(b.getAttribute(_.og).split(" ")));d=Array.from(b.attributes).map(function(n){return n.name});d=_.w(d);for(h=d.next();!h.done;h=d.next()){h=h.value;var m=Cx(h);g[m]=b.getAttribute(h)}d=g.backgroundImage}c=new cy(b,c,d,e,f,g);a.a.set(b,c);return c},hy=function(a){this.a=a;this.f=new DOMParser},iy=function(a){this.f=
a},jy=function(a){return String(Math.floor(a/3600)).padStart(2,"0")+":"+String(Math.floor(a/60%60)).padStart(2,"0")+":"+String(Math.floor(a%60)).padStart(2,"0")+"."+String(Math.floor(1E3*a%1E3)).padStart(3,"0")},ky=function(){},ly=function(a){this.a=new hy(a);this.g=new _.K("clpp.ttml.Mp4TtmlParser")},my=function(){this.j=new ky};qx.prototype.getId=function(){return this.h};qx.prototype.getAttribute=function(a){return this.a[a]};_.x(rx,qx);_.x(sx,qx);var ux=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,vx=/^(?:(\d{2,}):)?(\d{2}):(\d{2})$/,xx=/^(?:(\d{2,}):)?(\d{2}):(\d{2}\.\d+)$/,yx=/^(\d*(?:\.\d*)?)f$/,zx=/^(\d*(?:\.\d*)?)t$/,Ax=/^(?:(\d*(?:\.\d*)?)h)?(?:(\d*(?:\.\d*)?)m)?(?:(\d*(?:\.\d*)?)s)?(?:(\d*(?:\.\d*)?)ms)?$/,Mx=/^(\d{1,2}(?:\.\d+)?|100(?:\.0+)?)% (\d{1,2}(?:\.\d+)?|100(?:\.0+)?)%$/,Nx=/^(\d+)px (\d+)px$/,Tx=/^(\d+) (\d+)$/,Ex=/(\d+)px/,ny=/^(\d+px|\d+em|\d*\.?\d+c)$/,Xx=[ix,"color",jx,kx,"fontFamily","fontSize","fontStyle","fontWeight",
"lineHeight","opacity","padding",nx,ox,"textOutline",px,"zIndex"],fy=["begin",_.re];_.x(Hx,sx);
Hx.prototype.build=function(a,b,c,d,e,f,g){var h=Bx(this.a.begin,b);b=Bx(this.a.end,b);if(null===h||null===b)return null;h+=c;b+=c;c=_.Yp(_.be);for(var l=_.w(this.j),m=l.next();!m.done;m=l.next())c.appendChild(Jx(g.get(m.value),e,g));g=new _.xi(h,b,c.innerHTML.trim(),_.wg);g.cssClassList=_.fh(this.f).concat();g.textAlign=Ix(this,e,null);g.writingMode=_.ti;g.line=-1;g.lineInterpretation=_.ui;g.lineAlign=_.vi;g.containerRows=Rx(null,Ux(a),15);if(this.o&&(f=f.get(this.o))){g.region=f.build(a,e);g.textAlign=
Ix(this,e,f);a:switch(tx(f,e,px)){case "tb":case "tblr":a=_.Jg;break a;case "tbrl":a=_.Kg;break a;default:a=_.ti}g.writingMode=a;a:switch(tx(f,e,kx)){case _.wd:a=50;break a;case "after":a=-1;break a;default:a=0}g.line=a;a:switch(tx(f,e,kx)){case _.wd:a=1;break a;default:a=_.ui}g.lineInterpretation=a;a:switch(tx(f,e,kx)){case _.wd:e=_.wd;break a;default:e=_.vi}g.lineAlign=e}this.l&&(a=d.get(this.l))&&(d=a.getAttribute("encoding"),e=a.getAttribute("imageType")||a.getAttribute("imagetype"),a=a.j.trim(),
g.backgroundImage=("PNG"===e&&"Base64"===d&&0<a.length?"data:image/png;base64,"+a:null)||"");return g};_.x(Lx,sx);
Lx.prototype.build=function(a,b){var c=new _.Ai;c.id=this.getId();var d=Rx(a.j.containerWidth,Sx(a,1),720),e=Rx(a.j.containerHeight,Sx(a,2),480);a:switch(tx(this,b,kx)){case "after":var f="flex-start";break a;case _.wd:f=_.wd;break a;default:f="flex-end"}c.displayAlign=f;a:switch(tx(this,b,px)){case "tb":case "tblr":f="row-reverse";break a;case "tbrl":f="row";break a;default:f=_.Pd}c.writingMode=f;f=this.getAttribute("extent")||tx(this,b,"extent");c.width=Ox(f,d,1,100);c.widthUnits=Px(f,d);c.height=
Ox(f,e,2,100);c.heightUnits=Px(f,e);f=this.getAttribute("origin")||tx(this,b,"origin");c.viewportAnchorX=Ox(f,d,1,0);c.viewportAnchorY=Ox(f,e,2,0);c.viewportAnchorUnits=Px(f,d);c.cssClassList=_.fh(this.f).concat();return c};_.x(Qx,qx);_.x(Vx,qx);
Vx.prototype.build=function(a){var b=null;var c=Ux(a);c&&(b=Rx(a.j.containerHeight,Sx(a,2),480)/c);b=Rx(a.j.fontSizeRadix,b,16);a=[];c="::ttml ."+this.h+", ::ttml ."+this.h+" * {";for(var d=_.w(oy.entries()),e=d.next();!e.done;e=d.next()){var f=_.w(e.value);e=f.next().value;f=f.next().value;e in this.a&&(c+=f+":"+Dx(this.a[e])+";")}a:{if("unicodeBidi"in this.a){d=this.a.unicodeBidi;e="";switch(d){case "normal":case "embed":e=d;break;case "bidiOverride":e="bidi-override"}if(0<e.length){d="unicode-bidi:"+
e+";";break a}}d=""}c+=d;a:{if("textOutline"in this.a){d=this.a.textOutline.split(" ");e="black";f=".4em";var g=d[0]&&d[0].trim(),h=d[1]&&d[1].trim(),l=d[2]&&d[2].trim();3===d.length&&!ny.test(g)&&ny.test(h)&&ny.test(l)?(e=g,f=h):2===d.length&&!ny.test(g)&&ny.test(h)?(e=g,f=h):2===d.length&&ny.test(g)&&ny.test(h)&&(f=g);if(""!==f){f=Dx(f);d="text-shadow:0 0 "+(f+" "+e+",0 0 ")+(f+" "+e+",0 0 ")+(f+" "+e+";");break a}}d=""}c+=d;"textShadow"in this.a?(d=Gx(this.a.textShadow),d=Dx(d),d="text-shadow:"+
d+";"):d="";c=c+d+("fontFamily"in this.a?"font-family:"+this.a.fontFamily.replace("monospaceSansSerif","monospace").replace("monospaceSerif","monospace").replace("proportionalSansSerif",mx).replace("proportionalSerif",mx).replace("sansSerif",mx).replace("default",mx)+";":"");a:{if(ox in this.a){d=[];e=_.w(this.a.textDecoration.split(" "));for(f=e.next();!f.done;f=e.next())switch(f=f.value,f){case "underline":case "overline":d.push(f);break;case "lineThrough":d.push("line-through")}if(0<d.length){d=
"text-decoration:"+d.join(" ")+";";break a}}d=""}e="padding"in this.a?"border: solid transparent;border-width:"+Dx(this.a.padding)+";":"";c=c+d+e;"lineHeight"in this.a?(d="",e=this.a.lineHeight,e=Dx(e),e=Fx(e,b),d=d+"line-height:"+e+";"):d="";a.push(c+d+"}");a:{if("fontSize"in this.a&&(c=this.a.fontSize.split(" "),d=null,1===c.length&&(d=c[0]),2===c.length&&(d=c[1]),d)){d=d.trim();d=Dx(d);d=Fx(d,b);b="font-size:"+d+";";break a}b=null}b&&(c="::ttml ."+this.h+" .clpp-text-wrapper {",a.push(c+b+"}"),
c="::ttml .clpp-text-wrapper__"+this.h+" {",a.push(c+b+"}"));return a};var oy=new Map([[ix,"background-color"],["color","color"],[jx,jx],["fontStyle","font-style"],["fontWeight","font-weight"],["opacity","opacity"],["zIndex","z-index"]]);Wx.prototype.Fd=function(){var a=this;return this.o.map(function(b){return b.build(a.l,a.w,a.A,a.h,a.a,a.j,a.f)}).filter(function(b){return null!=b})};var $x=0;by.prototype.$c=function(){return!!this.a};by.prototype.next=function(){if(!this.a)return null;var a=this.a;do this.f.add(a),a.nodeType!==Node.TEXT_NODE&&!py.has(Cx(a.nodeName))||qy.has(Cx(a.nodeName))||!a.firstChild||this.f.has(a.firstChild)?a.nextSibling?a=a.nextSibling:a=a.parentNode:a=a.firstChild;while(a&&(this.f.has(a)||a.nodeType!==Node.TEXT_NODE&&!py.has(Cx(a.nodeName))));var b=this.a;this.a=a;return b};
var py=new Set(["tt","head","layout",_.Te,_.Be,lx,"styling",_.og,"body",_.be,"p","span","br"]),qy=new Set([_.og,_.Be]);cy.prototype.getId=function(){return this.attributes.id};hy.prototype.parseInit=function(){};
hy.prototype.parseMedia=function(a,b,c){c&&c.length||(c=[a.byteLength]);var d=_.M.Oa(this.a.ttml||{}),e=_.oj(a,0,c[0]);e=_.S.ba(e);if(""===e)return{cues:[],styles:[]};var f=null;try{f=this.f.parseFromString(e,_.tg)}catch(n){throw new _.N(_.O,2,2005,"Failed to parse TTML.");}d=new Wx(d);e=new ey;f=new by(f);b=b.periodStart;typeof b===_.k&&(d.A=b);b=c[0];for(var g=1;g<c.length;++g){var h=c[g],l=_.oj(a,b,h);l=_.yj(l);var m="urn:mpeg:14496-30:subs:"+g;d.h.set(m,new rx(m,l,{imageType:"PNG",encoding:"Base64"}));
b+=h}for(;f.$c();)a=f.next(),a=gy(e,a),"tt"===dy(a)&&(d.l=new Qx(d.B,Object.assign({},a.attributes))),"tt"===dy(a)&&(d.w=new Kx(a.attributes.frameRate,a.attributes.subFrameRate,a.attributes.frameRateMultiplier,a.attributes.tickRate)),dy(a)!==_.Be||a.attributes.begin||a.attributes.end||(c="#"+a.getId(),d.h.set(c,new rx(c,a.h.textContent,a.attributes))),dy(a)===_.Be&&a.attributes.begin&&a.attributes.end?(c="#"+ay(),b=new rx(c,a.h.textContent,a.attributes),d.h.set(c,b),c=b):c=null,c&&(a.j=c.getId()),
dy(a)===_.og&&(c=a.getId()||ay(),b=new Vx(c,a.f,Object.assign({},a.attributes)),d.a.set(c,b),a.a&&d.j.get(a.a).f.push(c)),dy(a)!==_.og&&Yx(a)?(c=ay(),b=new Vx(c,[],Object.assign({},a.attributes)),d.a.set(c,b),c=b):c=null,c&&a.f.push(c.getId()),dy(a)!==_.be||!a.attributes.extent&&!a.attributes.origin?c=null:(c=ay(),b=new Lx(c,Zx(d,a.f),Object.assign({},a.attributes)),d.j.set(c,b),c=b),c&&(a.a=c.getId()),dy(a)!==lx?c=null:(c=a.getId(),b=new Lx(c,Zx(d,a.f),Object.assign({},a.attributes)),d.j.set(c,b),
c=b),c&&(a.a=c.getId()),c=a.l,-1===["#text","span","br"].indexOf(dy(a))||0===c.length?c=null:(g=c[c.length-1],d.f.has(g)?(c=ay(),b=new Hx(c,"#text"===a.h.nodeName?a.h.textContent:null,"br"===dy(a),a.a,a.j,Zx(d,a.f),a.attributes),d.f.set(c,b),(g=d.f.get(g))&&g.j.push(c),c=b):c=null),c&&a.l.push(c.getId()),"p"===dy(a)||a.j?(c=ay(),b=new Hx(c,null,!1,a.a,a.j,Zx(d,a.f),a.attributes),d.f.set(c,b),d.o.push(b),c=b):c=null,c&&a.l.push(c.getId());e=d.Fd();f=[];a=_.w(d.a.values());for(c=a.next();!c.done;c=
a.next())f.push.apply(f,_.fh(c.value.build(d.l)));return{cues:e,styles:f}};iy.prototype.a=function(a){a=(new hy(this.f)).parseMedia(a,{periodStart:0,segmentStart:null,segmentEnd:0}).cues;var b="WEBVTT\n\n";a=_.w(a);for(var c=a.next();!c.done;c=a.next()){c=c.value;var d=jy(c.startTime)+" --\x3e "+jy(c.endTime),e=[];switch(c.textAlign){case _.Fe:e.push("align:left");break;case _.Wf:e.push("align:right");break;case _.si:e.push("align:middle");break;case _.Fe:e.push("align:start");break;case _.Wf:e.push("align:end")}switch(c.writingMode){case _.Jg:e.push("vertical:lr");break;
case _.Kg:e.push("vertical:rl")}b+=d+(e.length?" "+e.join(" "):"")+"\n";b+=c.payload+"\n\n"}return _.S.Wa(b)};ky.prototype.probe=function(a,b){return a===_.$c&&b===_.sg};ky.prototype.create=function(a){return new iy(a)};ly.prototype.parseInit=function(a){var b=!1;(new _.Rm).M(_.We,_.Sm).M(_.vg,_.Sm).M(_.Re,_.Sm).M(_.Ve,_.Sm).M(_.lg,_.Sm).Y(_.ng,_.Tm).M("stpp",function(c){b=!0;c.parser.stop()}).parse(a);if(!b)throw new _.N(_.O,2,2007);};
ly.prototype.parseMedia=function(a,b){var c=this,d=!1,e=[],f=[],g=[];(new _.Rm).M("moof",_.Sm).M("traf",_.Sm).Y("subs",function(h){for(var l=_.W(h.reader),m=0;m<l;++m){h.reader.skip(4);for(var n=_.Mm(h.reader),p=0;p<n;++p){var q=1===h.version?_.W(h.reader):_.Mm(h.reader);g.push(q);h.reader.skip(6)}}}).M(_.Qe,_.Um(function(h){d=!0;h=c.a.parseMedia(h,b,g);e=e.concat(h.cues);f=f.concat(h.styles)})).parse(a);d||this.g.warn("Couldn't find the mdat box");return{cues:e,styles:f}};_.x(my,_.Ts);my.prototype.f=function(){_.tu(_.$c,hy);_.tu(_.Yc,ly);_.tu(fx,ly);_.tu(hx,ly);_.tu(gx,ly);_.Kk.push(this.j)};my.prototype.a=function(){_.vu(_.$c);_.vu(_.Yc);_.vu(fx);_.vu(hx);_.vu(gx);_.Mk(this.j)};my.prototype.id=function(){return"subtitles-ttml"};_.J("clpp.ttml.TtmlComponent",my);};
if(typeof(module)!="undefined"&&module.exports){var x=require("./cl.core.js");_ = x._;(f.call(g,this));module.exports=g;}
else if (typeof(define)!="undefined"&&define.amd) {define(["./cl.core"], function(c){_=c._;(f.call(g,this));return g;});}
else{_=this.clpp._;(f.call(g,this));}
})();